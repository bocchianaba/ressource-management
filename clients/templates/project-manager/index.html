<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        {% load static %}
        <link rel="stylesheet" href="{% static 'css/Client.css' %}">
    </head>
    <body>
        <!-----------Navigation---------->
        <div class="container">
            <div class="navigation">
                <ul>
                    <li>
                        <a href="#">
                            <span class="icon">
                                <ion-icon name="home-outline"></ion-icon>
                            </span>
                            <span class="title">Gestion de Projet </span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'clients:projectsList' %}">
                            <span class="icon">
                                <ion-icon name="calendar"></ion-icon>
                            </span>
                            <span class="title">Liste de projets</span>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <span class="icon">
                                <ion-icon name="duplicate-outline"></ion-icon>
                            </span>
                            <span class="title">Liste de demandes</span>
                        </a>
                    </li>
                    {% comment %} <li>
                        <a href="/clients/contrats">
                            <span class="icon">
                                <ion-icon name="newspaper-outline"></ion-icon>
                            </span>
                            <span class="title">Contrat</span>
                        </a>
                    </li>
                    <li>
                        <a href="/clients/projets">
                            <span class="icon">
                                <ion-icon name="time-outline"></ion-icon>
                            </span>
                            <span class="title">Liste de projets</span>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <span class="icon">
                                <ion-icon name="today-outline"></ion-icon>
                            </span>
                            <span class="title">Liste des demandes</span>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <span class="icon">
                                <ion-icon name="receipt-outline"></ion-icon>
                            </span>
                            <span class="title">Rapport d'évaluation</span>
                        </a>
                    </li>  {% endcomment %}
                </ul> 
            </div>

            <div class="main">
                <div class="topbar" style="width: 100%;">
                    <div class="toggle">
                        <ion-icon name="menu-outline"></ion-icon>
                    </div>
                    {% if request.user.is_authenticated %}
                    <div style="display: flex; font-size: 25px;align-items: center;">
                        <ion-icon name="person-circle"></ion-icon>
                        <h6 style="margin-right: 16px;">{{ request.user.username }}</h6>
                        
                        <form action="{% url 'logout' %}" method="post">
                            {% csrf_token %}
                            <button class="btn-primary" style="background-color: #FF69B4; color: white;;" type="submit">
                                <ion-icon name="lock-closed"></ion-icon>
                                Déconnexion
                            </button>
                        </form>
                    </div>
                    {% else %}
                        <span>Non connecté</span>
                        <a href="{% url 'login' %}" class="btn-primary">Se connecter</a>
                    {% endif %}
                </div>    
                {% load static %}
<link rel="stylesheet" href="{% static 'css/projet.css' %}">
{% load static %}
<script src="{% static 'js/projet.js' %}"></script>


{% comment %} <button id="ajouterBtn" onclick="afficherForm()">
    <ion-icon name="add-circle"></ion-icon>
    Ajouter un projet
</button> {% endcomment %}

{% if projects_list %}
<h2 style="text-align: center;">Listes des projets</h2>
<table id="projetTable">
  <tr>
    <th>N°</th>
    <th>Nom du Projet</th>
    <th>Actions</th>
  </tr>
  <tbody>
      {% for project in projects_list %}
      <tr>
          <td> {{forloop.counter}} </td>
          <td> {{project.name}} </td>
          <td>
              <button 
                  style="background-color: #4CAF50; border:none; color: white; padding: 10px 20px; margin-right: 10px; text-align-center; display: inline-block; text-decoration: none; font-size: 12px; cursor: pointer; border-radius: 4px;" 
                  id="viewBtn-{{project.id}}" 
                  onclick="afficherPopup('{{project.name}}', '{{project.deadline}}', '{{project.budget}}', '{{project.description}}')">
                  <ion-icon name="eye"></ion-icon>
                  Voir
              </button>
          </td>
      </tr>
      {% endfor %}
  </tbody>
</table>
{% else %} 
<h4 style="text-align: center;">
    Aucun Projet enregistré pour le moment <br>
    Bien vouloir se rapprocher du directeur en cas de soucis
</h4>
{% endif %}
    

<div class="overlay" onclick="fermerPopup()"></div>

<div class="form-popup" id="formPopup">
  <h2>Enregistrer un projet</h2>
  <form id="projetForm" method="post" action="{% url 'clients:newProject' %}">
    {% csrf_token %}
    <input type="text" id="nom" name="nom" placeholder="Nom du projet" required>
    <input type="date" id="delai" name="delai" placeholder="Delai de livraison" required>
    <input type="number" min="0" id="budget" name="budget" placeholder="budget alloué au projet" required>
    <textarea name="description" id="description" placeholder="Description du projet" required></textarea>
    <button type="submit">Enregistrer</button>
    <button type="button" onclick="fermerPopup()">Fermer</button>
  </form>
</div>

<div class="popup" id="popupInfo"></div>
            </div>
        </div>
        {% load static %}
        <script src="{% static 'js/Client.js' %}"></script>
        {% load static %}
        <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
        {% load static %}
        <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    </body>
</html>